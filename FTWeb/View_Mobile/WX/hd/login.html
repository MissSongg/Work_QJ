<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>登录</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="stylesheet" href="css/mui.min.css">
		<link rel="stylesheet" href="css/app.css">
	

</head>
<style>
.mui-bar {
    background-color: rgba(75, 66, 66, 0.82);
}

.mui-title {
    color: #fff;
}

::input-placeholder {
    color: #242020;
}

::-webkit-input-placeholder {
    color: #242020;
}

.mui-title .mui-segmented-control {
    top: 3px;
    border: none;
    height: 43px;
}
</style>

<body class="bodybgLogin">
    <header class="mui-bar mui-bar-nav">
        <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
        <h1 class="mui-title">
            <div id="segmentedControl" class="mui-segmented-control">
              <a class="mui-control-item mui-active" href="#hnlLogin">登录</a>
              <a class="mui-control-item" href="#hnlRegist">注册 </a>
           </div>
        </h1>
    </header>
    <div id="loginBg">
        <div id="hnlLogin" class="mui-control-content mui-active">
            <input type="text" id="phone" name="" placeholder="手机号" maxlength="11">
            <input type="password" id="userPwd" name="" placeholder="密码">
            <!-- <a class="forgetpw right" href="#">忘记密码？</a> -->
            <a class="btnLogin1 marginTop" href="#">登录</a>
        </div>
        <div class="mui-control-content" id="hnlRegist">
            <input type="text" id="phone2" name="" placeholder="手机号" maxlength="11">
            <input type="password" id="userPwd2" name="" placeholder="密码">
            <input type="password" id="userPwd3" name="" placeholder="确认密码">
            <!-- <a class="forgetpw right" href="#">忘记密码？</a> -->
            <a class="btnLogin2 marginTop" href="#">注册</a>
        </div>
    </div>
</body>
    <script src="js/mui.min.js"></script>
<script type="text/javascript" src="js/jquery-1.12.2.min.js"></script>
<script>
function checkPhone(phone) {
    var phone = $.trim(phone);
    if (!(/^1(3|4|5|7|8)\d{9}$/.test(phone))) {
        alert("手机号码有误，请重填");
        return false;
    } else {
        return phone;
    }
}

function samePassword() {
    var userPwd2 = $.trim($("#userPwd2").val()); //去空格获取密码
    var userPwd3 = $.trim($("#userPwd3").val()); //去空格获取密码
    if ("" == userPwd2 || "" == userPwd3) {
        alert("请输入密码");
        return false;
    }
    if (userPwd2 == userPwd3) {
        return userPwd2;
    } else {
        alert("两次输入密码不一样");
        return false;
    }
}
   //alert(document.documentElement.clientHeight+"px");
    document.getElementsByTagName('body')[0].style.height = window.innerHeight+'px'; 
$(function() {
  
 

    $(".btnLogin1").click(function() {
        login();
    });
    $(".btnLogin2").click(function() {
        regist();
    });

    function login() {
        var phone = checkPhone($("#phone").val()); //去空格获取用户名
        var userPwd = $("#userPwd").val(); //去空格获取密码
        alert(userPwd);
        if (false != phone || userPwd == "") {
            alert("请输入手机号和密码")
        } else {
            checkPhone();
            $.ajax({
                cache: false, //禁止缓存
                type: "POST",
                url: "{:U('login')}",
                data: {
                    "phone": phone,
                    "userPwd": userPwd
                },
                error: function(request) {
                    alert("Connection error");
                },
                success: function(data) {
                    if (data) {
                        alert("登陆成功");

                    } else {
                        alert("用户名或密码错误");
                    }
                }

            });
        }

    }

    function regist() {
        var phone2 = checkPhone($("#phone2").val());
        if (false == phone2) {
            return;
        }
        var userpwd = samePassword();

        if (false == userpwd) {
            return;
        }

        $.ajax({
            cache: false, //禁止缓存
            type: "POST",
            url: "{:U('register')}",
            data: {
                "phone": phone2,
                "userpwd": userpwd
            },
            error: function(request) {
                alert("请刷新页面重新注册");
            },
            success: function(data) {
              // debugger;
                switch (data.status) {
                    case 0:
                        alert("手机号已注册");
                        break;
                    case 1:
                        alert("请刷新页面重新注册");
                        break;
                    case 2:
                        alert("注册成功");
                        location.href="{:U('Activity/indiana')}?uid="+data.uid;
                        break;
                }
            }

        });
    }

})
</script>

</html>
